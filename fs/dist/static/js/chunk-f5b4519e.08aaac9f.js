(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f5b4519e"],{"5bed":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticStyle:{margin:"5px 0"}},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:t.searchForm,size:"small"},nativeOn:{submit:function(t){t.preventDefault()}}},[a("el-form-item",{attrs:{label:""}},[a("el-input",{attrs:{placeholder:"名称"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.getData(e)}},model:{value:t.searchForm.name,callback:function(e){t.$set(t.searchForm,"name",e)},expression:"searchForm.name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:""}},[a("el-select",{attrs:{clearable:"",placeholder:"任务类型"},model:{value:t.searchForm.lang,callback:function(e){t.$set(t.searchForm,"lang",e)},expression:"searchForm.lang"}},[a("el-option",{attrs:{value:"shell",label:"Shell"}}),t._v(" "),a("el-option",{attrs:{value:"python3",label:"Python3"}}),t._v(" "),a("el-option",{attrs:{value:"api",label:"Api"}})],1)],1),t._v(" "),a("el-form-item",{attrs:{label:""}},[a("el-select",{attrs:{clearable:"",placeholder:"触发方式"},model:{value:t.searchForm.trigger,callback:function(e){t.$set(t.searchForm,"trigger",e)},expression:"searchForm.trigger"}},[a("el-option",{attrs:{value:"auto",label:"自动"}}),t._v(" "),a("el-option",{attrs:{value:"manual",label:"手动"}})],1)],1),t._v(" "),a("el-form-item",{attrs:{label:""}},[a("el-input",{attrs:{placeholder:"运行地址"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.getData(e)}},model:{value:t.searchForm.worker,callback:function(e){t.$set(t.searchForm,"worker",e)},expression:"searchForm.worker"}})],1),t._v(" "),a("el-form-item",{attrs:{label:""}},[a("el-select",{attrs:{clearable:"",placeholder:"状态"},model:{value:t.searchForm.status,callback:function(e){t.$set(t.searchForm,"status",e)},expression:"searchForm.status"}},[a("el-option",{attrs:{value:"running",label:"运行"}}),t._v(" "),a("el-option",{attrs:{value:"success",label:"成功"}}),t._v(" "),a("el-option",{attrs:{value:"timeout",label:"超时"}}),t._v(" "),a("el-option",{attrs:{value:"abort",label:"终止"}}),t._v(" "),a("el-option",{attrs:{value:"wait",label:"等待"}}),t._v(" "),a("el-option",{attrs:{value:"unknown",label:"未知"}})],1)],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:t.getData}},[t._v("查询")]),t._v(" "),a("el-button",{staticStyle:{float:"right"},on:{click:t.getData}},[t._v("刷新")])],1)],1)],1),t._v(" "),a("div",{staticStyle:{"margin-top":"10px"}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"tasklog",attrs:{border:"",data:t.data_list,size:"small"}},[a("el-table-column",{attrs:{type:"selection",width:"45",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{label:"",type:"expand"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"task-log-item"},[a("label",[t._v("执行内容:")]),t._v(" "),a("pre",{staticStyle:{"white-space":"pre-wrap","word-wrap":"break-word",margin:"1px"}},[t._v(t._s(e.row.data.data))])]),t._v(" "),a("div",{staticClass:"task-log-item"},[a("label",[t._v("返回结果:")]),t._v(" "),a("pre",{staticStyle:{"white-space":"pre-wrap","word-wrap":"break-word",margin:"1px"}},[t._v(t._s(e.row.resp))])]),t._v(" "),a("div",{staticClass:"task-log-item"},[a("label",[t._v("错误状态码:")]),t._v(" "),"success"!==e.row.result?a("span",[t._v(t._s(e.row.err_code))]):t._e()]),t._v(" "),a("div",{staticClass:"task-log-item"},[a("label",[t._v("错误信息:")]),t._v(" "),a("pre",{staticStyle:{"white-space":"pre-wrap","word-wrap":"break-word",margin:"1px"}},[t._v(t._s(e.row.err_msg))])])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"ID",prop:"id",width:"60"}}),t._v(" "),a("el-table-column",{attrs:{label:"名称",prop:"name",width:"150"}}),t._v(" "),a("el-table-column",{attrs:{label:"类型",prop:"lang",width:"80"}}),t._v(" "),a("el-table-column",{attrs:{label:"触发方式",prop:"trigger_method",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return["auto"===e.row.trigger_method?a("span",[t._v("自动")]):"manual"===e.row.trigger_method?a("span",[t._v("手动")]):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"表达式",prop:"expr",width:""}}),t._v(" "),a("el-table-column",{attrs:{label:"Worker",prop:"addr",width:""}}),t._v(" "),a("el-table-column",{attrs:{label:"耗时",prop:"cost_time",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.cost_time)+"s")]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"结果",prop:"",width:"100",align:""},scopedSlots:t._u([{key:"default",fn:function(t){return["success"===t.row.result?a("div",{staticStyle:{"vertical-align":"middle",display:"flex","flex-direction":"row","align-items":"center"}},[a("Badge",{attrs:{status:"success",text:"成功"}})],1):"failed"===t.row.result?a("div",[a("Badge",{attrs:{status:"error",text:"失败"}})],1):"running"===t.row.result?a("div",[a("Badge",{attrs:{status:"processing",text:"运行中"}})],1):"timeout"===t.row.result?a("div",[a("Badge",{attrs:{status:"error",text:"超时"}})],1):"abort"===t.row.result?a("div",[a("Badge",{attrs:{status:"warning",text:"终止"}})],1):a("div",[a("Badge",{attrs:{status:"default",text:t.row.result}})],1)]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"更新时间",prop:"mtime",width:"140"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-popconfirm",{attrs:{icon:"el-icon-info",title:"确认开始手动执行任务吗？"},on:{onConfirm:function(a){return t.abortTask(e.row)}}},[-1!==["wait","running"].indexOf(e.row.result)?a("delete_button",{attrs:{slot:"reference",title:"终止"},slot:"reference"}):t._e()],1),t._v(" "),a("delete_button",{attrs:{title:"删除"},on:{click:function(a){return t.confirmDelRows(e.row,e.row.name,e.row.id)}}})]}}])})],1),t._v(" "),a("div",{staticStyle:{"margin-top":"5px"}},[a("div",{staticClass:"block",staticStyle:{float:"left",display:"inline"}},[a("el-button",{staticStyle:{margin:"5px 0"},attrs:{size:"mini",type:"danger",plain:""},on:{click:function(e){return t.confirmDelBulkRows(t.$refs.tasklog.selection)}}},[t._v("批量删除")])],1),t._v(" "),a("div",{staticClass:"block",staticStyle:{float:"right",display:"inline"}},[a("pagination",{attrs:{total:t.total,page:t.page,limit:t.limit},on:{"update:page":function(e){t.page=e},"update:limit":function(e){t.limit=e},pagination:function(e){return t.getData()}}})],1)])],1)])},l=[],s=(a("7f7f"),a("96cf"),a("3b8d")),n=a("26e4"),o=a("5d46"),i=a("1db2"),c=a("d329"),u=a("8fb7d"),d=a("aa11"),p=a("fe8c"),m={name:"jobor_task_log",mixins:[p["a"]],data:function(){return{url:this.$store.state.urls.jobor_log_url,searchForm:{name:"",lang:"",worker:"",trigger:"",status:""}}},methods:{abortTask:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e){var a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,a="".concat(this.url,"/").concat(e.id,"/abort"),t.next=4,this.$store.dispatch("common/Request",{url:a,method:"POST",data:{}});case 4:return r=t.sent,this.$message({message:r.data.message,type:"success"}),t.next=8,this.getData();case 8:t.next=13;break;case 10:t.prev=10,t.t0=t["catch"](0),this.$message({message:String(t.t0),type:"error"});case 13:return t.prev=13,t.finish(13);case 15:case"end":return t.stop()}}),t,this,[[0,10,13,15]])})));function e(e){return t.apply(this,arguments)}return e}(),changeStatus:function(t,e){var a=this,r="<span style='color: #00c752'>运行</span>";"stop"===e&&(r="停止"),this.$confirm("确认任务名为["+t.name+"]执行"+r+"动作吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var r=a.url+"/"+t.id+"/"+e;a.$store.dispatch("common/CreateUpdate",{url:r,method:"PUT",data:{}}).then((function(t){a.$message.success(t.data.message),a.getData()})).catch((function(t){}))})).catch((function(){a.$message({type:"info",message:"已取消"})}))}},mounted:function(){this.getData()},components:{pagination:n["a"],delete_button:o["a"],edit_button:i["a"],user_select:d["a"],green_button:c["a"],detail_button:u["a"]}},v=m,f=(a("d7d9"),a("2877")),_=Object(f["a"])(v,r,l,!1,null,"2a22690f",null);e["default"]=_.exports},"8fb7d":function(t,e,a){"use strict";var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-button",{attrs:{type:"text",size:t.size},on:{click:t.handleClick}},[t._v(t._s(t.title))])},l=[],s={name:"delete",props:{size:{default:"mini"},title:{default:"详细"}},methods:{handleClick:function(t){this.$emit("click",t)}}},n=s,o=a("2877"),i=Object(o["a"])(n,r,l,!1,null,"14939b4e",null);e["a"]=i.exports},d354:function(t,e,a){},d7d9:function(t,e,a){"use strict";a("d354")}}]);